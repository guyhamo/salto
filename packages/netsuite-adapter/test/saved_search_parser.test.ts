/*
*                      Copyright 2021 Salto Labs Ltd.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with
* the License.  You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
import _ from 'lodash'
import * as savedSearchParser from '../src/saved_search_parser'

describe('saved search parser tests', () => {
  const emptyDefinition = 'b4c02181b32dd312b31406b8197bbd385526fe868be8cb5a5b3b70207f8a457a@GZC@2021.1.0.103@H4sIAAAAAAAAAL1ZX2/iOBB/X2m/Q5R7PlKqu70VCqxCYsDX/JPjtMu9RCm429yFBCWme+ynv4kDlIbQvQKuWgllbM9vPDOeGY/1L/8uUuWJFWWSZ32127lSFZbN8nmSfeurIR39+ln9Mvj4Qc/KMp/1AlYkcZr8YHPv/m8242ae8TjJWKEAm6zsiVl99ZHzZU/Tvn//3skYL1cJZ51ZvtDK2SNbxKUmpqnKKpn3VRpQi9xeX//+x+dPV70gfmLzgMXF7LE3W5U8X5Ti47frXvfTNfx1r7vdz9cg5U7mq05XVXiyYCWPF0vYw4t5ILuibKRfxMsliPpi5QDkqoRM2fwbK0DKgnVqSPjZbLbo1Cs7tWCO+NC1fab7MHP2kGQJBwhBBXq9zmrSYWTOylmRLHle7GhALRjIMafrJVNmaVyWfbXmQHZ0dRAgg5iTCLmUTHXtecU+n6c4XbFyjwK024qmPCQsFdO3rEdbglqP9dUbNI18w7wxxkhVtDOYBCbBPo2wpVa7+fGjr5a8AP8C3b+wsK4JticijTCyrchCIyO0aeQaDkg9Z0uWzcGf1zds3VftfBanzNqpvLfRIcXURr9cHYhnCvGUYF1ytlDcnDOlRle6l5B1iz710QF0jVlBnolkG+PID4c2NncY93mesjhTBw9xWl6Cv40DKo+77xEwj0QAxzAn2EXyAAhysGshIg8hmHh3YAb3RqIZCBohQpAl29w7HOmGf4aS7gLPUCOPOO+BQ1AAgTCQB3WL0V1kBABUGUo+zpgY/uQ9YPYS1cVRQhfsQgk2KZKD4hhfI+LdBaenbCGnhQNjaKPIIti2I8u7c+XoRCRCMwSPdc1pRAyKNvnwLOkn2ELRCNsUEdiB51fyyzkJVX2zrTko+kqjekc19mFWpwahwR2mkwu4knFrYFsYCbx2hCT5k4Aa297QsCNkYYnn3Axu5TFHX01kSwy71kji+UAOWDoaEc8541zscQrC4Z/IpJdhNvSs6WU4mZ7jwHXmzLMPwXU8RlUGNGwkMy8F5gRZof3uQGA+xzEIRhJze4Dcyio+ncqvI+pNGbYNJSx4ZnVbHEqsxGo47Jp2CElCZP32wpkXq0vgTSA6U48atkQVbnfjI4I9MBwYjxLDDQyTYk9S5qtP7jC0byLPh7NrnZO0n3mJfoYokiPfIIZzbiEzDCEVg4Ik6sDzKXbwX1BrwB3i3PAlTp7nRqFvQTEk+cZohJDRK1fB/z836lqjq6RrLU0s/SFJOSv2e086P+hnoZQtWMZfNLTq0inQNb7fzNK1JkO9XC0WcbEenQpUh9HpUcAj/PX4KU7S+D5l9YjQ7wnwz+XbMQFeB9ILxldFdio8QTQkbl2uHkK38tbnjINEpyJaiIoyph2xlbde5gU383S1yE4xMFxLITDZoeM28Y70Ruv+6gsaUJdxAay3eCBOymZVF1dVCvbAYGwGh63T0cR/8/i/rZu7J/KRnu4x2QX9TdcWYYiDHun9vOjF2bqXrdL0la4k+I/pEastEL1NEnB+EUPJfn8sybg6aO2xvpG5uMqiwISgit3xG6JpS5yriQcu0hIP27xWj1NWcFidLBPwppOjhqheQPnYx5Aqg2PH6VW0hiwXEOMn+FsEXWt9Cdk+pTQeTnbPKRsHTXZKbo6sFS78oNng3zwx/bTvX03aPBUJ9s0FTQUN9hkchpZ/2HpwpWvVz/7CIs7KNK6213Aq0FCxbrpffeYGLItCUO/mq33Oq+8ULSt1rYkIe2iTTteOaOLZYlsLNAz5wmRb8tHXQ5jz8cN/hW7w3oscAAA='
  const emptyDefinitionOutcome = { sort_columns: { KEY_FIELD: 'SystemNote_RECORD', FILELD_ORDER: 1, FLAG_DESCENDING: false }, KEY_SCRIPT_ID: 'customsearch42', FIELD_DEFAULT_NAME: 'Custom System Note Search 1', FIELD_SEARCH_TYPE: 'SystemNote', FLAG_PUBLIC: false, FLAG_LIST: false, FLAG_PORTLET: false, FLAG_MACHINE: false, FLAG_REMINDER: false, FLAG_SHOW_LINK: false, FLAG_PREFERRED_LIST: false, FLAG_PREFERRED_PORTLET: false, FLAG_PREFERRED_MACHINE: false, FLAG_PREFERRED_FORM: false, FLAG_PREFERRED_RESULTS: false, FLAG_VIEW_AS_REPORT: false, FLAG_VIEW_AS_GRAPH: false, FLAG_VIEW_AS_GRID: false, FLAG_UNRESTRICTED: false, FLAG_DISABLE_DRILL_DOWN: false, FLAG_HIDE_FILTER_DROPDOWNS: false, KEY_DEFAULT_TEXT_FIELD_FILTER: 'STARTSWITH', FLAG_AVAILABLE_AS_FEED: false, FLAG_GLOBAL_EDIT: false, FLAG_CSV: false, FLAG_EXCEL: false, FLAG_PDF: false, FLAG_TRIGGERED_ALERT: false, FLAG_SCHEDULED_ALERT: false, FLAG_SCHEDULED_ALERT_SUMMARIES: false, FLAG_SEND_EMPTY_RESULTS: false, FLAG_ALERT_ALLOW_SUBSCRIBE: false, FLAG_ALERT_INCLUDE_VIEW_LINK: true, FLAG_HAS_TOTALS: false, FLAG_INCLUDE_PERIOD_END_TRANSACTIONS: false, FLAG_BUILT_IN: false, FLAG_SEND_ON_UPDATE: false, FLAG_SHOW_AUDIT_TRAIL: false }
  const listedDefinition = 'fa27ea1c6c972ca12a9f669727478059d6c3cfcb4b66b6a43242a1a918b22498@GZC@2021.1.0.103@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'
  const listedDefinitionOutcome = { search_filter: [{ FLAG_DATE_TIME_SECOND: false, FLAG_FROM_AVAILABLE_FILTER: false, FLAG_NOT: false, FLAG_OR: false, FIELD_OR_CLAUSE_STATUS: 'N', FIELD_NUM_LEFT_PARENS: 0, FIELD_NUM_RIGHT_PARENS: 0, FIELD_FILTER_NAME: 'SystemNote_NEWVALUE', FIELD_ATTRIBUTE: 'STARTSWITH', FIELD_TYPE: 'TEXT', RECORDS: [{ KEY_ID: 0, FIELD_VALUE: 'dede' }] }, { FLAG_DATE_TIME_SECOND: false, FLAG_FROM_AVAILABLE_FILTER: false, FLAG_NOT: false, FLAG_OR: false, FIELD_OR_CLAUSE_STATUS: 'N', FIELD_NUM_LEFT_PARENS: 0, FIELD_NUM_RIGHT_PARENS: 0, FIELD_FILTER_NAME: 'SystemNote_TYPE', FIELD_ATTRIBUTE: 'ANY', FIELD_TYPE: 'CHECKBOX', RECORDS: [] }], search_summary_filters: [{ FLAG_DATE_TIME_SECOND: false, FLAG_FROM_AVAILABLE_FILTER: false, FLAG_NOT: false, FLAG_OR: false, FIELD_OR_CLAUSE_STATUS: 'N', FIELD_NUM_LEFT_PARENS: 0, FIELD_NUM_RIGHT_PARENS: 0, FIELD_FILTER_NAME: 'COUNT_SystemNote_RECORDTYPE', FIELD_ATTRIBUTE: 'EQUAL', FIELD_TYPE: 'TEXT', RECORDS: [{ KEY_ID: 0, FIELD_VALUE: '5' }, { KEY_ID: 1 }] }, { FLAG_DATE_TIME_SECOND: false, FLAG_FROM_AVAILABLE_FILTER: false, FLAG_NOT: false, FLAG_OR: false, FIELD_OR_CLAUSE_STATUS: 'N', FIELD_NUM_LEFT_PARENS: 0, FIELD_NUM_RIGHT_PARENS: 0, FIELD_FILTER_NAME: 'COUNT_SystemNote_RECORDID', FIELD_ATTRIBUTE: 'EQUAL', FIELD_TYPE: 'INTEGER', RECORDS: [{ KEY_ID: 0, FIELD_VALUE: '3' }, { KEY_ID: 1 }] }], available_filters: [{ SEQ_NUMBER: 1, FIELD_NAME: 'SystemNote_CONTEXT', FLAG_FOOTER: false, FLAG_FOOTER_MULTI_SELECT: false }, { SEQ_NUMBER: 2, FIELD_NAME: 'SystemNote_DATE', FLAG_FOOTER: false, FLAG_FOOTER_MULTI_SELECT: false }], return_fields: [{ FIELD_ALIAS: 'SystemNote_RECORD', FIELD_INDEX: 1, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_NAME', FIELD_INDEX: 2, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_DATE', FIELD_INDEX: 3, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_CONTEXT', FIELD_INDEX: 4, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_TYPE', FIELD_INDEX: 5, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_FIELD', FIELD_INDEX: 6, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_OLDVALUE', FIELD_INDEX: 7, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_NEWVALUE', FIELD_INDEX: 8, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_ROLE', FIELD_INDEX: 9, FIELD_FORMULA_ERROR: false }], detail_fields: [{ FIELD_ALIAS: 'SystemNote_RECORD', FIELD_INDEX: 1, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_NAME', FIELD_INDEX: 2, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_DATE', FIELD_INDEX: 3, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_CONTEXT', FIELD_INDEX: 4, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_TYPE', FIELD_INDEX: 5, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_FIELD', FIELD_INDEX: 6, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_OLDVALUE', FIELD_INDEX: 7, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_NEWVALUE', FIELD_INDEX: 8, FIELD_FORMULA_ERROR: false }, { FIELD_ALIAS: 'SystemNote_ROLE', FIELD_INDEX: 9, FIELD_FORMULA_ERROR: false }], sort_columns: { KEY_FIELD: 'SystemNote_RECORD', FILELD_ORDER: 1, FLAG_DESCENDING: false }, 'audience:': { FLAG_AUDIENCE_ALL_CUSTOMERS: false, FLAG_AUDIENCE_ALL_EMPLOYEES: true, FLAG_AUDIENCE_ALL_PARTNERS: true, FLAG_AUDIENCE_ALL_ROLES: true, FLAG_AUDIENCE_ALL_VENDORS: false }, alert_recipients: [{ FIELD_NAME: 'SystemNote_ROLE' }, { FIELD_NAME: 'SystemNote_NAME' }], KEY_SCRIPT_ID: 'customsearch37', FIELD_DEFAULT_NAME: 'Custom System Note Search 2', FIELD_SEARCH_TYPE: 'SystemNote', FLAG_PUBLIC: false, FLAG_LIST: false, FLAG_PORTLET: false, FLAG_MACHINE: false, FLAG_REMINDER: false, FLAG_SHOW_LINK: false, FLAG_PREFERRED_LIST: false, FLAG_PREFERRED_PORTLET: false, FLAG_PREFERRED_MACHINE: false, FLAG_PREFERRED_FORM: false, FLAG_PREFERRED_RESULTS: false, FLAG_VIEW_AS_REPORT: false, FLAG_VIEW_AS_GRAPH: false, FLAG_VIEW_AS_GRID: false, FLAG_UNRESTRICTED: false, FLAG_DISABLE_DRILL_DOWN: false, FLAG_HIDE_FILTER_DROPDOWNS: false, KEY_DEFAULT_TEXT_FIELD_FILTER: 'STARTSWITH', FLAG_AVAILABLE_AS_FEED: false, FLAG_GLOBAL_EDIT: false, FLAG_CSV: false, FLAG_EXCEL: false, FLAG_PDF: false, FLAG_TRIGGERED_ALERT: false, FLAG_SCHEDULED_ALERT: false, FLAG_SCHEDULED_ALERT_SUMMARIES: false, FLAG_SEND_EMPTY_RESULTS: false, FLAG_ALERT_ALLOW_SUBSCRIBE: false, FLAG_ALERT_INCLUDE_VIEW_LINK: true, FLAG_HAS_TOTALS: false, FLAG_INCLUDE_PERIOD_END_TRANSACTIONS: false, FLAG_BUILT_IN: false, FLAG_SEND_ON_UPDATE: false, FLAG_SHOW_AUDIT_TRAIL: false, KEY_AUDIENCE: 105 }
  const singlesDefinition = '573ceffd2f3de51420c9c5a1d2d10c7a79ca8a288224e0c9ae12e853e942c16a@GZC@2021.1.0.103@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'
  const singlesDefinitionoUTCOME = { search_filter: [{ FLAG_DATE_TIME_SECOND: false, FLAG_FROM_AVAILABLE_FILTER: false, FLAG_NOT: false, FLAG_OR: false, FIELD_OR_CLAUSE_STATUS: 'N', FIELD_NUM_LEFT_PARENS: 0, FIELD_NUM_RIGHT_PARENS: 0, FIELD_FILTER_NAME: 'SystemNote_DATE', FIELD_MODIFIER: 'WITHIN', FIELD_ATTRIBUTE: 'CUSTOM', FIELD_TYPE: 'DATETIME', RECORDS: [{ KEY_ID: 0, FIELD_VALUE: '2021-07-15 08:00:00.0 UTC' }, { KEY_ID: 1, FIELD_VALUE: '2021-07-22 09:00:00.0 UTC' }] }], search_summary_filters: [{ FLAG_DATE_TIME_SECOND: false, FLAG_FROM_AVAILABLE_FILTER: false, FLAG_NOT: false, FLAG_OR: false, FIELD_OR_CLAUSE_STATUS: 'N', FIELD_NUM_LEFT_PARENS: 0, FIELD_NUM_RIGHT_PARENS: 0, FIELD_FILTER_NAME: 'COUNT_SystemNote_RECORD', FIELD_ATTRIBUTE: 'EQUAL', FIELD_TYPE: 'TEXT', RECORDS: [{ KEY_ID: 0, FIELD_VALUE: '3' }, { KEY_ID: 1 }] }], available_filters: [{ SEQ_NUMBER: 1, FIELD_NAME: 'SystemNote_CONTEXT', FLAG_FOOTER: false, FLAG_FOOTER_MULTI_SELECT: false }], return_fields: [{ FIELD_ALIAS: 'SystemNote_RECORD', FIELD_INDEX: 1, FIELD_FORMULA_ERROR: false }], detail_fields: [{ FIELD_ALIAS: 'SystemNote_RECORD', FIELD_INDEX: 1, FIELD_FORMULA_ERROR: false }], sort_columns: { KEY_FIELD: 'SystemNote_RECORD', FILELD_ORDER: 1, FLAG_DESCENDING: false }, 'audience:': { FLAG_AUDIENCE_ALL_CUSTOMERS: false, FLAG_AUDIENCE_ALL_EMPLOYEES: true, FLAG_AUDIENCE_ALL_PARTNERS: false, FLAG_AUDIENCE_ALL_ROLES: false, FLAG_AUDIENCE_ALL_VENDORS: false }, alert_recipients: [{ FIELD_NAME: 'SystemNote_ROLE' }], KEY_SCRIPT_ID: 'customsearch40', FIELD_DEFAULT_NAME: 'Custom System Note Search 4', FIELD_SEARCH_TYPE: 'SystemNote', FLAG_PUBLIC: false, FLAG_LIST: false, FLAG_PORTLET: false, FLAG_MACHINE: false, FLAG_REMINDER: false, FLAG_SHOW_LINK: false, FLAG_PREFERRED_LIST: false, FLAG_PREFERRED_PORTLET: false, FLAG_PREFERRED_MACHINE: false, FLAG_PREFERRED_FORM: false, FLAG_PREFERRED_RESULTS: false, FLAG_VIEW_AS_REPORT: false, FLAG_VIEW_AS_GRAPH: false, FLAG_VIEW_AS_GRID: false, FLAG_UNRESTRICTED: false, FLAG_DISABLE_DRILL_DOWN: false, FLAG_HIDE_FILTER_DROPDOWNS: false, KEY_DEFAULT_TEXT_FIELD_FILTER: 'STARTSWITH', FLAG_AVAILABLE_AS_FEED: false, FLAG_GLOBAL_EDIT: false, FLAG_CSV: false, FLAG_EXCEL: false, FLAG_PDF: false, FLAG_TRIGGERED_ALERT: false, FLAG_SCHEDULED_ALERT: false, FLAG_SCHEDULED_ALERT_SUMMARIES: false, FLAG_SEND_EMPTY_RESULTS: false, FLAG_ALERT_ALLOW_SUBSCRIBE: false, FLAG_ALERT_INCLUDE_VIEW_LINK: true, FLAG_HAS_TOTALS: false, FLAG_INCLUDE_PERIOD_END_TRANSACTIONS: false, FLAG_BUILT_IN: false, FLAG_SEND_ON_UPDATE: false, FLAG_SHOW_AUDIT_TRAIL: false, KEY_AUDIENCE: 104 }
  it('test parse definition1', async () => {
    const parsedDefinition = await savedSearchParser.parseDefinition(emptyDefinition)
    expect(_.isEqual(parsedDefinition, emptyDefinitionOutcome)).toBeTruthy()
  })
  it('test parse listed definition', async () => {
    const parsedDefinition = await savedSearchParser.parseDefinition(listedDefinition)
    expect(_.isEqual(parsedDefinition, listedDefinitionOutcome)).toBeTruthy()
  })
  it('test parse singles definition', async () => {
    const parsedDefinition = await savedSearchParser.parseDefinition(singlesDefinition)
    expect(_.isEqual(parsedDefinition, singlesDefinitionoUTCOME)).toBeTruthy()
  })
})
